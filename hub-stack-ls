#!/bin/bash -e

HUB_WORKDIR="${HUB_WORKDIR:-$(pwd)}"

CURRENT=""
if test -f ".env"; then
  CURRENT=$(basename "$(readlink .env)" .env)
fi

if test ! -d .hub/env; then
  echo "No stacks available"
  exit 1
fi

echo "ACTIVE  STACK"
for f in $HUB_WORKDIR/.hub/env/*.env $HUB_WORKDIR/.hub/env/.env; do
  STACK=$(basename $f .env)
  if test ! -f "$f"; then
    continue
  fi
  STAR=" "
  if test "$CURRENT" = "$STACK"; then
    STAR="*"
  fi
  if test "$STACK" == ".env"; then
    STACK="initialized"
  fi
  echo "$STAR       $STACK"
done
