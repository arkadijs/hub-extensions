#!/bin/bash -e

usage() {
  cat << EOF
Print colored message (if terminal supports colorings)

Parameters:
  -c --color COLOR_CODE   Use color with this code
  -n                      Do not print the trailing newline character
  -V --verbose            For debug purpose
  -h --help               Show this message

Subcommands:
  h or hightlight    MSG  Prints bold white
  w, warn or warning MSG  Prints bold yellow
  e, err or error    MSG  Prints bold red

EOF
}

message=""
color=""

_tput() {
  if test -t 1; then
    tput $@
  fi
}

finalize() {
  if test -t 1; then
    tput sgr0
  fi
}

echo="echo"

while test -n "$1"; do
  case $1 in
    -h | --help )
      usage
      exit ;;
    -V | --verbose )
      set -x
      continue
    ;;
    -c | --color )
      shift
      _tput setaf "$1"
      shift
      continue
    ;;
    -n )
      shift
      echo="echo -n"
      continue
    ;;
    -b | --bold | b | bold )
      shift
      _tput bold
      continue
    ;;
    w | warn | warning )
      _tput setaf 3
      _tput bold
      continue
    ;;
    e | err | error )
      _tput setaf 1
      _tput bold
    ;;
    h | highlight )
      _tput setaf 7
      _tput bold
    ;;
    * )
      message="$@"
      break
      ;;
  esac
  shift
done

trap finalize EXIT

$echo "$message"
